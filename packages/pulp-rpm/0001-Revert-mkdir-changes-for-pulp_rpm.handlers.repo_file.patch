From c4b1c29eed96895455464a4e5e9e8a9f289d6938 Mon Sep 17 00:00:00 2001
From: Grant Gainey <ggainey@redhat.com>
Date: Wed, 18 Nov 2020 11:21:33 -0500
Subject: [PATCH] Revert mkdir() changes for pulp_rpm.handlers.repo_file.Repo
 and CertFiles.

fixes #7849
---
 handlers/pulp_rpm/handlers/repo_file.py | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git handlers/pulp_rpm/handlers/repo_file.py handlers/pulp_rpm/handlers/repo_file.py
index 78a7ba52..f79af1ff 100644
--- handlers/pulp_rpm/handlers/repo_file.py
+++ handlers/pulp_rpm/handlers/repo_file.py
@@ -3,7 +3,6 @@ import shutil
 
 from iniparse import ConfigParser
 from pulp.common.util import encode_unicode
-from pulp.plugins.util import misc
 
 
 class Repo(dict):
@@ -410,7 +409,7 @@ class RepoKeyFiles(object):
         # If there are any keys to write, create the directory for the repo's keys
         # and write each of them out
         if len(self.keys) > 0:
-            misc.mkdir(self.repo_keys_dir)
+            os.makedirs(self.repo_keys_dir)
 
             for filename in self.keys:
                 f = open(filename, 'w')
@@ -460,7 +459,7 @@ class CertFiles(object):
         if not self.clientcert:
             return None
 
-        misc.mkdir(self.rootdir)
+        self.__mkdir()
         path = os.path.join(self.rootdir, self.CLIENT)
         f = open(path, 'w')
         f.write(self.clientcert)
@@ -470,6 +469,10 @@ class CertFiles(object):
     def __nocerts(self):
         return not self.clientcert
 
+    def __mkdir(self):
+        if not os.path.exists(self.rootdir):
+            os.makedirs(self.rootdir)
+
     def __clear(self):
         if os.path.exists(self.rootdir):
             shutil.rmtree(self.rootdir)
-- 
2.28.0

